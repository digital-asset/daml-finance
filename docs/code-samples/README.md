# Daml Finance - Code Samples

Daml Finance has a daml `quickstarter`, which generates a template project of `Daml Finance` with
sample code generated via the `daml new quickstart-finance` command. This code-sample is documented
as part of the `Daml Finance` documentation in the tutorial guide. As the documentation is generated
as part of our `Daml Finance` library, the code needs to live in this repository but the code also
needs to also be part of the `daml` repository to enable running the `daml new quickstart-finance`
command.

## Updating the getting-started code

The [getting-started](getting-started/) code that is part of this repository is fully replicated
inside the
[daml repository](https://github.com/digital-asset/daml/tree/main/templates/quickstart-finance).
The only exception is the [daml.yaml](getting-started/daml.yaml) file, which is required for both
local testing and for the CI and **must not** be replicated in the daml repository (this file gets
generated based off the [daml.yaml.template](getting-started/daml.yaml.template) file when
processing the daml command).

### Updating the project

1. Make the necessary code changes.
2. Update the *version* in both the [daml.yaml.template](getting-started/daml.yaml.template) and
   the [daml.yaml](getting-started/daml.yaml) files.
3. Create a new config file in [getting-started-config](getting-started-config/) with the file name
   being the new *version* set in step 2, with a file extension of `.conf`.

    ```{}
    getting-started-config/{version}.conf
    ```

4. Update the dependencies in the new configuration file as necessary. The format of the file is

    ```{}
    <full_http_url> <dependency_path>
    ```

    where `full_http_url` is the full http url to download the dependency from. `dependency_path` is
    the path and name to install the dependency to, matching what is specified in the
    [daml.yaml.template](getting-started/daml.yaml.template) and
    [daml.yaml](getting-started/daml.yaml) files.
5. Ensure that the code compiles (i.e., run `./get-dependencies.sh && daml build`);
6. Copy the contents of the [folder](getting-started/) with **the exception** of the
   [daml.yaml](getting-started/daml.yaml) file to the
   [daml repository](https://github.com/digital-asset/daml/tree/main/templates/quickstart-finance).
7. To test against the daml code base, build the daml repository by running `daml-sdk-head` in the
   root of the repository (this may take a while...).
8. Run `daml-head new quickstart-finance-test --template quickstart-finance` to generate the
   quickstarter.
9. Ensure that the quickstarter builds: navigate to the folder generated by the quickstarter
    (i.e., `quickstart-finance-test\`) and run `./get-dependencies.sh && daml-head build`.
10. Remove the created quickstart directory (i.e., `quickstart-finance-test\`) once testing is
    complete.
11. Raise a PR against the `main` Daml branch and ask the daml team to approve the PR.
