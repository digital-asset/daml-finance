-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

module Daml.Finance.Lifecycle.Types where

import DA.Time (time)
import Daml.Finance.Interface.Types.Date.Classes (HasUTCTimeConversion(..))

-- | A `Date` which can be converted to `Time` (it is converted to UTC noon).
newtype Unit = Unit Date deriving (Eq)

instance HasUTCTimeConversion Unit where
  toUTCTime (Unit d) = time d 12 00 00

instance Ord Unit where
  x <= y = toUTCTime x <= toUTCTime y

instance Show Unit where
  show (Unit d) = show d

