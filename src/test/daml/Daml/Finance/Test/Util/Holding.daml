-- Copyright (c) 2022 Digital Asset (Switzerland) GmbH and/or its affiliates. All rights reserved.
-- SPDX-License-Identifier: Apache-2.0

module Daml.Finance.Test.Util.Holding where

import DA.Assert ((===))
import Daml.Finance.Interface.Holding.Entry qualified as Entry (I, GetView(..))
import Daml.Script

-- | Verify that a party is the owner of a holding.
verifyOwnerOfHolding : forall a. (HasToInterface a Entry.I) => [(Party, ContractId a)] -> Script [()]
verifyOwnerOfHolding l = forA l
  \(owner, holdingCid) -> do
    v <- submit owner do exerciseCmd (toInterfaceContractId @Entry.I holdingCid) Entry.GetView with viewer = owner
    v.account.owner === owner
